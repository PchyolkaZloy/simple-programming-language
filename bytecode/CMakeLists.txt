cmake_minimum_required(VERSION 3.10)
project(Bytecode)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# –ò—â–µ–º ANTLR4 runtime
# –ù–µ –∏—â–µ–º, –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –Ω–∞–π–¥—ë–º üò≠
#find_package(ANTLR REQUIRED)

set(SOURCES
        src/SmplangLexer.cpp
        src/SmplangParser.cpp
        src/SmplangBaseVisitor.cpp
        src/SmplangVisitor.cpp
        src/SmplangBaseListener.cpp
        src/SmplangListener.cpp
)

set(HEADERS
        include/SmplangLexer.h
        include/SmplangParser.h
        include/SmplangBaseVisitor.h
        include/SmplangVisitor.h
        include/SmplangBaseListener.h
        include/SmplangListener.h
)

set(DLL_PATH "${CMAKE_CURRENT_SOURCE_DIR}/antlr4-cpp-runtime-vs2022/lib/vs-2022/x64/Release DLL/antlr4-runtime.dll")
set(LIB_PATH "${CMAKE_CURRENT_SOURCE_DIR}/antlr4-cpp-runtime-vs2022/lib/vs-2022/x64/Release DLL/antlr4-runtime.lib")
# –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
add_library(Bytecode STATIC ${SOURCES} ${HEADERS})
add_library(antlr4-runtime STATIC IMPORTED)
set_target_properties(antlr4-runtime PROPERTIES
        IMPORTED_LOCATION "${LIB_PATH}"
)
configure_file("${DLL_PATH}" "${CMAKE_BINARY_DIR}/antlr4-runtime.dll" COPYONLY)

# –ü–æ–¥–∫–ª—é—á–∞–µ–º ANTLR runtime –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ
target_link_libraries(Bytecode antlr4-runtime)
# –£–∫–∞–∑—ã–≤–∞–µ–º, –≥–¥–µ –∏—Å–∫–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã
target_include_directories(Bytecode PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)
# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ ANTLR4
target_include_directories(Bytecode PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/antlr4-cpp-runtime-vs2022/antlr4-runtime)

# main.cpp –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
add_executable(SmplangParserTest main.cpp)
target_link_libraries(SmplangParserTest Bytecode)
target_link_libraries(SmplangParserTest antlr4-runtime)
